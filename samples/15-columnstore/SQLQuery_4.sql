-- 5 billion?
select format(count_big(*), 'n0') from lineitem
--5,999,989,709

select 
    L_SHIPDATE,
    COUNT_BIG(*) AS COUNT_ORDER
from 
    dbo.LINEITEM
where
    L_SHIPMODE = 'MAIL'
group by
    L_SHIPDATE
order by    
    L_SHIPDATE

select L_RETURNFLAG,
    L_LINESTATUS,
    SUM(L_QUANTITY) AS SUM_QTY,
    SUM(L_EXTENDEDPRICE) AS SUM_BASE_PRICE,
    SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS SUM_DISC_PRICE,
    SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)*(1+L_TAX)) AS SUM_CHARGE,
    AVG(L_QUANTITY) AS AVG_QTY,
    AVG(L_EXTENDEDPRICE) AS AVG_PRICE,
    AVG(L_DISCOUNT) AS AVG_DISC,
    FORMAT(COUNT_BIG(*), 'n0') AS COUNT_ORDER
from 
    LINEITEM
WHERE 
    L_SHIPDATE BETWEEN '1997-10-01' AND '1997-10-31'
group by
    L_RETURNFLAG,
    L_LINESTATUS
order by 
    L_RETURNFLAG,
    L_LINESTATUS


